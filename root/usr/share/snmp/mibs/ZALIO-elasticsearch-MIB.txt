ZALIO-elasticsearch-MIB DEFINITIONS ::= BEGIN

IMPORTS
    OBJECT-TYPE, MODULE-IDENTITY,
    Integer32, Counter32, Gauge32
        FROM SNMPv2-SMI

   TEXTUAL-CONVENTION, DisplayString, TruthValue
        FROM SNMPv2-TC

    MODULE-COMPLIANCE, OBJECT-GROUP
        FROM SNMPv2-CONF

    zalApps, zalConformance, zalCompliances, zalGroups
        FROM ZALIO-MIB;

zalElasticsearch MODULE-IDENTITY
    LAST-UPDATED "201403170000Z"
    ORGANIZATION "zalio AG"
    CONTACT-INFO
        "email:    hans.riethmann@zal.io"
    DESCRIPTION
        "The zalio application MIB for elasticsearch."

    REVISION     "201403170000Z"
    DESCRIPTION
        "First version created."
    ::= { zalConformance 22 }

    zalEs             OBJECT IDENTIFIER ::= { zalApps 10 }
    zalEsCluster      OBJECT IDENTIFIER ::= { zalEs 1 }
    zalEsNode         OBJECT IDENTIFIER ::= { zalEs 2 }


-- The textual conventions we define and use in this MIB.
-- =======================================================

EsStatusTC ::= TEXTUAL-CONVENTION
    STATUS     current
    DESCRIPTION
        "elasticsearch return status, which is returned as  'red', 'green' or 'yellow'"
    SYNTAX     INTEGER {
        green(1),
        yellow(2),
        red(3)
    }


-- Cluster objects
-- =======================================================

zalEsStatus OBJECT-TYPE -- Cluster
    SYNTAX        EsStatusTC 
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "cluster_health->{status}"
    ::= { zalEsCluster 1 }

zalEsClusterName OBJECT-TYPE -- Cluster
    SYNTAX        DisplayString
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "cluster_health->{cluster_name}"
    ::= { zalEsCluster 2 }

zalEsNrNodes OBJECT-TYPE -- Cluster
    SYNTAX        Integer32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "cluster_health->{number_of_nodes}"
    ::= { zalEsCluster 3 }

zalEsNrDataNodes OBJECT-TYPE -- Cluster
    SYNTAX        Integer32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "cluster_health->{number_of_data_nodes}"
    ::= { zalEsCluster 4 }

zalEsDocsCount OBJECT-TYPE -- Cluster
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "cluster_stats->{indices}->{docs}->{count}"
    ::= { zalEsCluster 5 }

zalEsDocsDel OBJECT-TYPE -- Cluster
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "cluster_stats->{indices}->{docs}->{deleted}"
    ::= { zalEsCluster 6 }

zalEsStoreSize OBJECT-TYPE -- Cluster
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "cluster_stats->{indices}->{store}->{size_in_bytes}"
    ::= { zalEsCluster 7 }

zalEsStoreThr OBJECT-TYPE -- Cluster
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "cluster_stats->{indices}->{store}->{throttle_time_in_millis}"
    ::= { zalEsCluster 8 }

zalEsMaster OBJECT-TYPE -- Cluster
    SYNTAX        TruthValue
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "cluster_state->{master_node}"
    ::= { zalEsCluster 9 }

-- Cluster group definition

zalEsClusterGroup OBJECT-GROUP
    OBJECTS { zalEsStatus,
              zalEsClusterName,
              zalEsNrNodes,
              zalEsNrDataNodes,
              zalEsDocsCount,
              zalEsDocsDel,
              zalEsStoreSize,
              zalEsStoreThr,
              zalEsMaster
            }
    STATUS  current
    DESCRIPTION
            "A collection of objects providing basic instrumentation and
            control of an elasticsearch cluster."
    ::= { zalGroups 1 }


-- Node objects
-- =======================================================

zalEsNodeName OBJECT-TYPE -- Node
    SYNTAX        DisplayString
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{name}"
    ::= { zalEsNode 1 }

zalEsIndexTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{indexing}->{index_total}"
    ::= { zalEsNode 2 }

zalEsIndexTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{indexing}->{index_time_in_millis}"
    ::= { zalEsNode 3 }

zalEsFlushTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{flush}->{total}"
    ::= { zalEsNode 4 }

zalEsFlushTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{flush}->{total_time_in_millis}"
    ::= { zalEsNode 5 }

zalEsThrottleTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{store}->{throttle_time_in_millis}"
    ::= { zalEsNode 6 }

zalEsDeleteTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{indexing}->{delete_total}"
    ::= { zalEsNode 7 }

zalEsDeleteTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{indexing}->{delete_time_in_millis}"
    ::= { zalEsNode 8 }

zalEsGetTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{total}"
    ::= { zalEsNode 9 }

zalEsGetTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{time_in_millis}"
    ::= { zalEsNode 10 }

zalEsExistsTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{exists_total}"
    ::= { zalEsNode 11 }

zalEsExistsTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{exists_time_in_millis}"
    ::= { zalEsNode 12 }

zalEsMissingTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{missing_total}"
    ::= { zalEsNode 13 }

zalEsMissingTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{missing_time_in_millis}"
    ::= { zalEsNode 14 }

zalEsQueryTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{search}->{query_total}"
    ::= { zalEsNode 15 }

zalEsQueryTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{search}->{query_time_in_millis}"
    ::= { zalEsNode 16 }

zalEsFetchTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{search}->{fetch_total}"
    ::= { zalEsNode 17 }

zalEsFetchTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{search}->{fetch_time_in_millis}"
    ::= { zalEsNode 18 }

zalEsMergeTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{merges}->{total}"
    ::= { zalEsNode 19 }

zalEsMergeTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{merges}->{total_time_in_millis}"
    ::= { zalEsNode 20 }

zalEsRefreshTotal OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{refresh}->{total}"
    ::= { zalEsNode 21 }

zalEsRefreshTime OBJECT-TYPE -- Node
    SYNTAX        Counter32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{refresh}->{total_time_in_millis}"
    ::= { zalEsNode 22 }

zalEsProcMemRes OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{process}->{mem}->{resident_in_bytes}"
    ::= { zalEsNode 23 }

zalEsProcMemShr OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{process}->{mem}->{share_in_bytes}"
    ::= { zalEsNode 24 }

zalEsProcCpuSys OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{process}->{cpu}->{sys_in_millis}"
    ::= { zalEsNode 25 }

zalEsProcCpuUsr OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{process}->{cpu}->{user_in_millis}"
    ::= { zalEsNode 26 }

zalEsJvmHp OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{jvm}->{mem}->{heap_used_in_bytes}"
    ::= { zalEsNode 27 }

zalEsJvmHpPerc OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{jvm}->{mem}->{heap_used_percent}"
    ::= { zalEsNode 28 }

zalEsJvmHpCmt OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{jvm}->{mem}->{heap_committed_in_bytes}"
    ::= { zalEsNode 29 }

zalEsJvmHpMax OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{jvm}->{mem}->{heap_max_in_bytes}"
    ::= { zalEsNode 30 }

zalEsJvmNonHp OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{jvm}->{mem}->{non_heap_used_in_bytes}"
    ::= { zalEsNode 31 }

zalEsJvmNonHpCmt OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{jvm}->{mem}->{non_heap_committed_in_bytes}"
    ::= { zalEsNode 32 }

zalEsTrspRxDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{transport}->{rx_count}"
    ::= { zalEsNode 33 }

zalEsTrspTxDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{transport}->{tx_count}"
    ::= { zalEsNode 34 }

zalEsTrspRxSzDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{transport}->{rx_size_in_bytes}"
    ::= { zalEsNode 35 }

zalEsTrspTxSzDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{transport}->{tx_size_in_bytes}"
    ::= { zalEsNode 36 }

zalEsSrchQrDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{search}->{query_total}"
    ::= { zalEsNode 37 }

zalEsSrchFtDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{search}->{fetch_total}"
    ::= { zalEsNode 38 }

zalEsSrchQrTmDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{search}->{query_time_in_millis}"
    ::= { zalEsNode 39 }

zalEsSrchFtTmDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{search}->{fetch_time_in_millis}"
    ::= { zalEsNode 40 }

zalEsGetDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{total}"
    ::= { zalEsNode 41 }

zalEsGetExDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{exists_total}"
    ::= { zalEsNode 42 }

zalEsGetMisDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{missing_total}"
    ::= { zalEsNode 43 }

zalEsGetTmDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{time_in_millis}"
    ::= { zalEsNode 44 }

zalEsGetExTmDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{exists_time_in_millis}"
    ::= { zalEsNode 45 }

zalEsGetMisTmDel OBJECT-TYPE -- Node
    SYNTAX        Gauge32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "node_stats->{indices}->{get}->{missing_time_in_millis}"
    ::= { zalEsNode 46 }

-- Node group definition

zalEsNodeGroup OBJECT-GROUP
    OBJECTS { 
             zalEsNodeName,
             zalEsIndexTotal,
             zalEsIndexTime,
             zalEsFlushTotal,
             zalEsFlushTime,
             zalEsThrottleTime,
             zalEsDeleteTotal,
             zalEsDeleteTime,
             zalEsGetTotal,
             zalEsGetTime,
             zalEsExistsTotal,
             zalEsExistsTime,
             zalEsMissingTotal,
             zalEsMissingTime,
             zalEsQueryTotal,
             zalEsQueryTime,
             zalEsFetchTotal,
             zalEsFetchTime,
             zalEsMergeTotal,
             zalEsMergeTime,
             zalEsRefreshTotal,
             zalEsRefreshTime,
             zalEsProcMemRes,
             zalEsProcMemShr,
             zalEsProcCpuSys,
             zalEsProcCpuUsr,
             zalEsTrspRxDel,
             zalEsTrspTxDel,
             zalEsTrspRxSzDel,
             zalEsTrspTxSzDel,
             zalEsSrchQrDel,
             zalEsSrchFtDel,
             zalEsSrchQrTmDel,
             zalEsSrchFtTmDel,
             zalEsGetDel,
             zalEsGetExDel,
             zalEsGetMisDel,
             zalEsGetTmDel,
             zalEsGetExTmDel,
             zalEsGetMisTmDel,
             zalEsJvmHp,
             zalEsJvmHpPerc,
             zalEsJvmHpCmt,
             zalEsJvmHpMax,
             zalEsJvmNonHp,
             zalEsJvmNonHpCmt
            }
    STATUS  current
    DESCRIPTION
            "A collection of objects providing basic instrumentation and
            control of an elasticsearch node."
    ::= { zalGroups 2 }


-- Indices table
-- =======================================================

zalEsIndicesTable OBJECT-TYPE
    SYNTAX     SEQUENCE OF ZalEsIndicesEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
        "A list of elasticsearch cluster state entries."
    ::= { zalEsCluster 10 }

zalEsIndicesEntry OBJECT-TYPE
    SYNTAX     ZalEsIndicesEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
        "A collection of cluster relevant information
         describing its state"
    INDEX { zalEsIndicesIndex }
    ::= { zalEsIndicesTable 1 }

ZalEsIndicesEntry ::= SEQUENCE {
    zalEsIndicesIndex                Integer32,
    zalEsIndStatus                   EsStatusTC,
    zalEsIndName                     DisplayString,
    zalEsShrdStatus                  EsStatusTC,
    zalEsShrdActive                  Integer32,
    zalEsShrdReloc                   Integer32,
    zalEsShrdInit                    Integer32,
    zalEsShrdUnas                    Integer32,
    zalEsShrdPrim                    Integer32,
    zalEsShrdRepl                    Integer32
}


-- Indices table objects
-- =======================================================

zalEsIndicesIndex OBJECT-TYPE
    SYNTAX        Integer32 (0..2147483647)
    MAX-ACCESS    not-accessible
    STATUS        current
    DESCRIPTION
        "cluster_health->{indices}"
    ::= { zalEsIndicesEntry 1 }

zalEsIndStatus OBJECT-TYPE
    SYNTAX        EsStatusTC
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "{status}"
    ::= { zalEsIndicesEntry 2 }

zalEsIndName OBJECT-TYPE
    SYNTAX        DisplayString
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "{name}"
    ::= { zalEsIndicesEntry 3 }

zalEsShrdStatus OBJECT-TYPE
    SYNTAX        EsStatusTC
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "{status}"
    ::= { zalEsIndicesEntry 4 }

zalEsShrdActive OBJECT-TYPE
    SYNTAX        Integer32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "{active_shards}"
    ::= { zalEsIndicesEntry 5 }

zalEsShrdReloc OBJECT-TYPE
    SYNTAX        Integer32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "{relocating_shards}"
    ::= { zalEsIndicesEntry 6 }

zalEsShrdInit OBJECT-TYPE
    SYNTAX        Integer32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "{initializing_shards}"
    ::= { zalEsIndicesEntry 7 }

zalEsShrdUnas OBJECT-TYPE
    SYNTAX        Integer32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "{unassigned_shards}"
    ::= { zalEsIndicesEntry 8 }

zalEsShrdPrim OBJECT-TYPE
    SYNTAX        Integer32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "{active_primary_shards}"
    ::= { zalEsIndicesEntry 9 }

zalEsShrdRepl OBJECT-TYPE
    SYNTAX        Integer32
    MAX-ACCESS    read-only
    STATUS        current
    DESCRIPTION
        "{number_of_replicas}"
    ::= { zalEsIndicesEntry 10 }

-- Indices group definition

zalEsIndicesGroup OBJECT-GROUP
    OBJECTS {
             zalEsIndStatus,
             zalEsIndName,
             zalEsShrdStatus,
             zalEsShrdActive,
             zalEsShrdReloc,
             zalEsShrdInit,
             zalEsShrdUnas,
             zalEsShrdPrim,
             zalEsShrdRepl
            }
    STATUS  current
    DESCRIPTION
            "A collection of objects providing basic instrumentation and
            control of an elasticsearch node."
    ::= { zalGroups 3 }

 
-- Compliance
zalEsCompliance MODULE-COMPLIANCE
    STATUS current
    DESCRIPTION
        "still finding out how this all fits together"
    MODULE
        GROUP zalEsClusterGroup
            DESCRIPTION
                "dito"
        GROUP zalEsNodeGroup
            DESCRIPTION
                "dito"
        GROUP zalEsIndicesGroup
            DESCRIPTION
                "dito"
    ::= { zalCompliances 20 }

END
